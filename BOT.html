<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZAIS.ai Secure Chatbot</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .chat-container {
            width: 100%;
            max-width: 600px;
            height: 95vh;
            max-height: 800px;
            background: white;
            border-radius: 24px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.25);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }
        .chat-header {
            background: linear-gradient(to right, #6e48aa, #9d50bb);
            color: white;
            padding: 20px 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            z-index: 2;
        }
        .chat-title {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .chat-title i {
            font-size: 1.5rem;
            background: rgba(255, 255, 255, 0.2);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .chat-title h2 {
            font-weight: 600;
            font-size: 1.4rem;
        }
        .api-status {
            padding: 10px 15px;
            background: rgba(255, 255, 255, 0.15);
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(5px);
        }
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #4cd964;
            box-shadow: 0 0 10px rgba(76, 217, 100, 0.5);
        }
        .chat-messages {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
            background: #f8f9fa;
            position: relative;
        }
        .message {
            max-width: 80%;
            padding: 16px 20px;
            border-radius: 20px;
            line-height: 1.5;
            animation: fadeIn 0.3s ease;
            position: relative;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .bot-message {
            align-self: flex-start;
            background: white;
            border-bottom-left-radius: 5px;
            color: #2d3748;
            border: 1px solid #e2e8f0;
        }
        .user-message {
            align-self: flex-end;
            background: linear-gradient(to right, #6e48aa, #9d50bb);
            color: white;
            border-bottom-right-radius: 5px;
        }
        .timestamp {
            font-size: 0.7rem;
            margin-top: 8px;
            opacity: 0.7;
            text-align: right;
        }
        .typing-indicator {
            display: none;
            align-self: flex-start;
            background: white;
            padding: 16px 20px;
            border-radius: 20px;
            color: #718096;
            font-style: italic;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        .typing-indicator.active {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .typing-dots {
            display: flex;
            gap: 4px;
        }
        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #a0aec0;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }
        .typing-dot:nth-child(1) { animation-delay: 0s; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }
        .chat-input {
            display: flex;
            padding: 20px;
            background: white;
            border-top: 1px solid #eaeaea;
            gap: 12px;
            position: relative;
            z-index: 2;
        }
        .message-input {
            flex: 1;
            padding: 16px 20px;
            border: 1px solid #e2e8f0;
            border-radius: 24px;
            outline: none;
            font-size: 1rem;
            transition: all 0.3s;
            background: #f8f9fa;
        }
        .message-input:focus {
            border-color: #6e48aa;
            box-shadow: 0 0 0 3px rgba(110, 72, 170, 0.1);
            background: white;
        }
        .send-button {
            background: linear-gradient(to right, #6e48aa, #9d50bb);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(110, 72, 170, 0.3);
        }
        .send-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(110, 72, 170, 0.4);
        }
        .send-button:active {
            transform: translateY(0);
        }
        .chat-background {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            opacity: 0.03;
            pointer-events: none;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%236e48aa' fill-rule='evenodd'/%3E%3C/svg%3E");
        }
        .api-key-info {
            padding: 15px;
            margin: 10px;
            background: #fff8e1;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
            font-size: 0.9rem;
            color: #856404;
        }
        @media (max-width: 700px) {
            .chat-container {
                width: 100vw;
                height: 100vh;
                max-width: 100vw;
                max-height: 100vh;
                border-radius: 0;
            }
            .chat-header, .chat-input, .chat-messages {
                padding-left: 16px;
                padding-right: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-background"></div>
        <div class="chat-header">
            <div class="chat-title">
                <i class="fas fa-robot"></i>
                <h2>ZAIS.ai</h2>
            </div>
            <div class="api-status">
                <div class="status-indicator"></div>
                <span>Connected to OpenRouter API</span>
            </div>
        </div>
        <div class="chat-messages" id="chat-messages">
            <div class="message bot-message">
                Hello! I'm ZAIS.ai, your AI assistant powered by OpenRouter. How can I help you today?
                <div class="timestamp">Just now</div>
            </div>
            <div class="api-key-info">
                <strong>Note:</strong> This demo is using a simulated backend. For production, use the provided Node.js backend.
            </div>
            <div class="typing-indicator" id="typing-indicator">
                <span>AI is thinking</span>
                <div class="typing-dots">
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                    <div class="typing-dot"></div>
                </div>
            </div>
        </div>
        <div class="chat-input">
            <input type="text" class="message-input" id="message-input" placeholder="Type your message here...">
            <button class="send-button" id="send-button">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const chatMessages = document.getElementById('chat-messages');
            const messageInput = document.getElementById('message-input');
            const sendButton = document.getElementById('send-button');
            const typingIndicator = document.getElementById('typing-indicator');
            
            // Focus input on load
            messageInput.focus();
            
            // Function to send a message
            sendButton.addEventListener('click', sendMessage);
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            // Sample responses for demonstration
            const sampleResponses = [
                "I'm an AI assistant powered by OpenRouter. How can I help you today?",
                "That's an interesting question. I'd be happy to help with that!",
                "I understand what you're asking. Let me provide some information on that topic.",
                "Thanks for your message. I'm here to assist with any questions you might have.",
                "I'm designed to provide helpful and accurate responses to your queries."
            ];
            
            // Simulate API call with sample responses
            function simulateOpenRouterAPI(message) {
                return new Promise((resolve) => {
                    // Simulate network delay
                    setTimeout(() => {
                        // Generate a response based on the message or use a random sample
                        let response;
                        
                        if (message.toLowerCase().includes('hello') || message.toLowerCase().includes('hi')) {
                            response = "Hello there! How can I assist you today?";
                        } else if (message.toLowerCase().includes('help')) {
                            response = "I'm here to help! What do you need assistance with?";
                        } else if (message.toLowerCase().includes('name')) {
                            response = "I'm ZAIS.ai, an AI assistant powered by OpenRouter.";
                        } else if (message.toLowerCase().includes('weather')) {
                            response = "I don't have real-time weather data, but I can help you find weather information if you tell me your location.";
                        } else if (message.toLowerCase().includes('time')) {
                            response = "I don't have access to real-time data in this demo, but you can check your device's clock for the current time.";
                        } else {
                            // Use a random sample response
                            const randomIndex = Math.floor(Math.random() * sampleResponses.length);
                            response = sampleResponses[randomIndex];
                        }
                        
                        resolve(response);
                    }, 1500); // Simulate 1.5 second response time
                });
            }
            
            async function sendMessage() {
                const message = messageInput.value.trim();
                if (message) {
                    addMessage(message, 'user');
                    messageInput.value = '';
                    typingIndicator.classList.add('active');
                    
                    try {
                        // Try to connect to the backend first
                        const response = await fetchBackendResponse(message);
                        typingIndicator.classList.remove('active');
                        addMessage(response, 'bot');
                    } catch (error) {
                        // If backend fails, use simulation
                        console.error("Backend error, using simulation:", error);
                        const response = await simulateOpenRouterAPI(message);
                        typingIndicator.classList.remove('active');
                        addMessage(response, 'bot');
                    }
                }
            }
            
            // This function would be used in a real implementation with a backend
            async function fetchBackendResponse(userMessage) {
                // This endpoint would be your backend server that securely stores the API key
                const BACKEND_URL = "http://localhost:3000/api/server1.js"; // Changed from server.js to server1.js

                const response = await fetch(BACKEND_URL, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        message: userMessage
                    })
                });

                if (!response.ok) {
                    throw new Error(`Backend error: ${response.status}`);
                }

                const data = await response.json();
                return data.response;
            }
            
            function addMessage(text, sender) {
                const messageElement = document.createElement('div');
                messageElement.classList.add('message');
                messageElement.classList.add(sender + '-message');
                messageElement.textContent = text;
                
                const timestamp = document.createElement('div');
                timestamp.classList.add('timestamp');
                timestamp.textContent = getCurrentTime();
                messageElement.appendChild(timestamp);
                
                chatMessages.insertBefore(messageElement, typingIndicator);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            function getCurrentTime() {
                const now = new Date();
                return now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            }
        });
    </script>
</body>
</html>